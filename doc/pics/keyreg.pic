.PS
figname = keyreg;

dx = 0.15; dy = 0.15; m = 0.1;
h = 0.8; w = 0.4;
xh = 0.5; xw = 0.3;

boxht = h; boxwid = w;


right;
FN:  box "Frontend" "Node"; move m;
C1: box "Client" "Node1"; move m;
C2: box "Client" "Node2"; move m;
C3: box "Client" "Node3"; move m;
C4: box "Client" "Node4"; move m;
C5: box "Client" "Node5"; move m;
C5: box "Client" "Node6";
move left w*7+m*6;

down;

move down h;
move down h;

right;

KDS1: box "KDS"; move m;
KDS2: box "KDS"; move m; move m;

move up h/2 right (w*5+m*3)/2;

down;

DFS: box ht m*2 wid xw*6+m*5 "distributed file system (Ceph)";

move m;

move left (w*5+m*3)/2 down xh/2;

right;
boxht = xh; boxwid = xw;

MDS1: box "MDS"; move m;
MDS2: box "MDS"; move m;
box "..." wid (xw-m)/2 invis; move m;
OSD1: box "OSD"; move m;
OSD2: box "OSD"; move m;
OSD3: box "OSD"; move m;
box "..." wid (xw-m)/2 invis;

down;

ellipse "$A$" wid w+dx ht h/4 at FN.n-(0,dy/2)

spline -> down m*8+dy from FN.sw+(m,dy) to KDS1.nw+(m,m*4) then down m*4+dy*2
spline -> down m*8+dy from FN.sw+(m,dy) to KDS2.nw+(m,m*4) then down m*4+dy*2
"$KR_A$(private key)" at FN.w-(0,h) rjust

spline -> down m*2+dy from FN.sw+(m*2,dy) to MDS1.nw+(m,m*4) then down m*4+dy

"$\mbox{fileID: }path, \mbox{ext attr: } (bs,d,E_{KU_A}(K_R))$" at C1.w-(0,h-dy) ljust
"$\mbox{fileID: }path, \mbox{ext attr: } (C_k,i_k,j_k)$" at C1.w-(0,h) ljust



.PE

